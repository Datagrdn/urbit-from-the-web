
<head>
    <meta charset="UTF-8">
    <title>Urbit from the Web</title>

    <script src="/~/at/=home=/web/lib/js/urb.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>
    <script src="/=home=/web/public/main.js"></script>

    <style>
        hidden {
          display: none;
        }
    </style>

</head>

<body class="hidden">

    <div id="publicStationShip">
        <h2 id="publicStationShipH2"></h2>
        <br />
    </div>

    <div id="userPostBox">
        <input type="text" id="post" size="64" value="">
        <button onclick='sendPublicPost();'>Post!</button>
        <br />
    </div>

    <div id="publicStationPosts">
    </div>

    <script>
      if (!(window.urb.ship === window.urb.user && window.urb.user === window.urb.auth[0])) {
        window.location = 'http://' + window.location.host + '/~~/public.html';
      } else {
        listen(window.urb.user);
        loadSources(window.urb.user);
        loadPublicStation(window.urb.user);
        var publicStationUser = '<h2 id="publicStationShipH2">' + window.urb.user + '</h2>';
        document.getElementById('publicStationShipH2').innerHTML = publicStationUser;
        document.body.classList.remove = 'hidden';
      }

      function fullPublicStation(ship) {
        return '~' + ship + '/' + 'public';
      }

      function sendPublicPost() {
        var txt = document.getElementById("post").value;
        var audi = fullPublicStation(window.urb.user);
        return postToPublicStation(txt, audi);
      }
    </script>

</body>

</html>
