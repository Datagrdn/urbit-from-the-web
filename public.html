
<head>
    <meta charset="UTF-8">
    <title>Urbit from the Web</title>

    <script src="/~/at/=home=/web/lib/js/urb.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>
    <script src="/=home=/web/public/main.js"></script>

    <style>
        hidden {
          display: none;
        }
    </style>

</head>

<body class="hidden">

    <div class="hidden" id="publicStationShip">
        <h2 id="publicStationShipH2"></h2>
        <br />
    </div>

    <div class="hidden" id="userPostBox">
        <input type="text" id="post" maxlength="160" width="64" heigt="3" value="">
        <button onclick='sendPublicPost();'>Post!</button>";
        <br />
    </div>

    <!-- <div class="hidden" id="shipSubscribeButton">
        <button onclick="subscribePublicStation(feedShip, window.sources.push(fullPublicStation(ship)))"><h3>Subscribe</h3></button>
        <br />
    </div>

    <div class="hidden" id="shipUnsubscribeButton">
        <button onclick="unsubscribeShipFeed(feedShip, window.sources)"><h3>Subscribed</h3></button>
        <br />
    </div>
 -->
    <div class="hidden" id="publicStationPosts">
    </div>

    <script>
      // var feedShip = sessionStorage.getItem('feedShip');
      //
      // function getPublicStation(ship) {
      //   while (ship.charAt(0) === '~') {
      //     ship = ship.substr(1);
      //   }
      //   if (ship == window.urb.user) {
      //     return console.log("You are viewing your public station.");
      //   } loadPublicStation(ship);
      //   sessionStorage.setItem('feedShip', ship);
      // }

      if (!(window.urb.ship === window.urb.user && window.urb.user === window.urb.auth[0])) {
        window.location = 'http://' + window.location.host + '/~~/public.html';
      } else {
        listen(window.urb.user);
        loadSources(window.urb.user);
        // if (window.sources) {
        //   checkMainStationSubbedPublic(fullPublicStation(window.urb.user), window.urb.user, window.sources);
        // }
        loadPublicStation(window.urb.user);
        var publicStationUser = '<h2 id="publicStationShipH2">' + window.urb.user + '</h2>';
        document.getElementById('publicStationShipH2').innerHTML = publicStationUser;
        document.getElementById('publicStationShip').className = '';
        document.body.className = '';
      }

      function fullPublicStation(ship) {
        return '~' + ship + '/' + 'public';
      }

      function sendPublicPost() {
        var text = document.getElementById("post").value;
        var audi = fullPublicStation(window.urb.user);
        return postToPublicStation(txt, audi);
      }

      // if (!feedShip && window.urb.ship === window.urb.user && window.urb.user === window.urb.auth[0]) {
      // }

      // if (feedShip && !(feedShip === window.urb.user) && window.urb.ship === window.urb.user && window.urb.user === window.urb.auth[0]) {
      //   if (!(_.includes(window.sources, fullPublicStation(feedShip)))) {
      //     document.getElementById('shipSubscribeButton').className = '';
      //   } else {
      //     document.getElementById('shipUnsubscribeButton').className = '';
      //   }
      // }
    </script>

</body>

</html>
